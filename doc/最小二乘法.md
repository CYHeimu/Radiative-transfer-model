# 最小二乘法

最小二乘法是一种在误差估计、不确定度、系统辨识及预测、预报等数据处理诸多学科领域得到广泛应用的数学工具。

**定义**

最小二乘法（又称最小平方法）是一种数学优化技术。它通过最小化误差的平方和寻找数据的最佳函数匹配，利用最小二乘法可以简便地求得未知的数据，并使得这些求得的数据与实际数据之间误差的平方和为最小。

最小二乘法还可用于曲线拟合，其他一些优化问题也可通过最小化能量或最大化熵用最小二乘法来表达。

**基本思路**

最小二乘法是解决曲线拟合问题最常用的方法。其基本思路是：令
$$
f(x) = a_1 \varphi_1(x) + a_2 \varphi_2(x) + a_m \varphi_m(x)
$$
其中，$\varphi_k(x)$是事先选定的一组线性无关的函数，$a_k$是待定系数$(k = 1, 2, \dots,m,m < n)$，拟合准则是使$y_i(i = 1, 2, \dots, n)$与$f(x_i)$的距离$\delta_i$的平方和最小，称为最小二乘准则。

**基本原理**

设(x,y)是一对观测量，且$x = [\omega_1, \omega_2, \dots, \omega_n]^T \in R^n, y = R$满足以下的理论函数：
$$
y = f(x, \omega)
$$
其中$x = [\omega_1, \omega_2, \dots, \omega_n]^T$为待定参数。

为了寻找函数$y = f(x, \omega)$的参数$\omega$的最优估计值，对于给定$m$组（通常$m > n$）观测数据$(x_i, y_i)(i = 1, 2, \dots, m)$，求解目标函数
$$
L(y, f(x, \omega)) = \sum^m_{i = 1} [y_i - f(x_i, w_i)]^2
$$
取最小值的参数$w_i(i = 1, 2, \dots, n)$。求解的这类问题称为最小二乘问题，求解该问题的方法的几何语言称为最小二乘拟合。

对于无约束最优化问题，最小二乘法的一般形式为：
$$
\min f(x) = \sum^m_{i = 1}L^2_i(x) = \sum^m_{i = 1} L^2_i[y_i, f(x_i, \omega_i)] = \sum^m_{i = 1} [y_i - f(x_i, w_i)]^2
$$
其中$L_i(x)(i = 1, 2, \dots, m)$称为残差函数。当$L_i(x)(i = 1, 2, \dots, m)$是$x$的线性函数时，称为线性最小二乘问题，否则称为非线性最小二乘问题。